import{Scene as e,OrthographicCamera as t,WebGLRenderer as i,TextureLoader as n,LinearFilter as o,VideoTexture as a,ShaderMaterial as r,Vector4 as s,PlaneBufferGeometry as f,Mesh as l}from"three";export default function(d){var u="\nvarying vec2 vUv;\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",v="\nvarying vec2 vUv;\n\nuniform float dispFactor;\nuniform float dpr;\nuniform sampler2D disp;\n\nuniform sampler2D texture1;\nuniform sampler2D texture2;\nuniform float angle1;\nuniform float angle2;\nuniform float intensity1;\nuniform float intensity2;\nuniform vec4 res;\nuniform vec2 parent;\n\nmat2 getRotM(float angle) {\n  float s = sin(angle);\n  float c = cos(angle);\n  return mat2(c, -s, s, c);\n}\n\nvoid main() {\n  vec4 disp = texture2D(disp, vUv);\n  vec2 dispVec = vec2(disp.r, disp.g);\n\n  vec2 uv = 0.5 * gl_FragCoord.xy / (res.xy) ;\n  vec2 myUV = (uv - vec2(0.5))*res.zw + vec2(0.5);\n\n\n  vec2 distortedPosition1 = myUV + getRotM(angle1) * dispVec * intensity1 * dispFactor;\n  vec2 distortedPosition2 = myUV + getRotM(angle2) * dispVec * intensity2 * (1.0 - dispFactor);\n  vec4 _texture1 = texture2D(texture1, distortedPosition1);\n  vec4 _texture2 = texture2D(texture2, distortedPosition2);\n  gl_FragColor = mix(_texture1, _texture2, dispFactor);\n}\n";function p(){for(var e=arguments,t=0;t<arguments.length;t++)if(void 0!==e[t])return e[t]}console.log("%c Hover effect by Robin Delaporte: https://github.com/robin-dela/hover-effect ","color: #bada55; font-size: 0.8rem");var g=d.parent,m=d.displacementImage,c=d.image1,h=d.image2,y=p(d.imagesRatio,1),F=p(d.intensity1,d.intensity,1),w=p(d.intensity2,d.intensity,1),x=p(d.angle,Math.PI/4),H=p(d.angle1,x),W=p(d.angle2,3*-x),R=p(d.speedIn,d.speed,1.6),b=p(d.speedOut,d.speed,1.2),P=p(d.hover,!0),E=p(d.easing,Expo.easeOut),S=p(d.video,!1);if(g)if(c&&h&&m){var U=new e,C=new t(g.offsetWidth/-2,g.offsetWidth/2,g.offsetHeight/2,g.offsetHeight/-2,1,1e3);C.position.z=1;var D=new i({antialias:!1,alpha:!0});D.setPixelRatio(2),D.setClearColor(16777215,0),D.setSize(g.offsetWidth,g.offsetHeight),g.appendChild(D.domElement);var O=function(){D.render(U,C)},V=new n;V.crossOrigin="";var _,z,M=V.load(m,O);if(M.magFilter=M.minFilter=o,S){var I=function(){requestAnimationFrame(I),D.render(U,C)};I(),(S=document.createElement("video")).autoplay=!0,S.loop=!0,S.src=c,S.load();var L=document.createElement("video");L.autoplay=!0,L.loop=!0,L.src=h,L.load();var A=new a(S),j=new a(L);A.magFilter=j.magFilter=o,A.minFilter=j.minFilter=o,L.addEventListener("loadeddata",function(){L.play(),(j=new a(L)).magFilter=o,j.minFilter=o,q.uniforms.texture2.value=j},!1),S.addEventListener("loadeddata",function(){S.play(),(A=new a(S)).magFilter=o,A.minFilter=o,q.uniforms.texture1.value=A},!1)}else A=V.load(c,O),j=V.load(h,O),A.magFilter=j.magFilter=o,A.minFilter=j.minFilter=o;var k=y;g.offsetHeight/g.offsetWidth<k?(_=1,z=g.offsetHeight/g.offsetWidth/k):(_=g.offsetWidth/g.offsetHeight*k,z=1);var q=new r({uniforms:{intensity1:{type:"f",value:F},intensity2:{type:"f",value:w},dispFactor:{type:"f",value:0},angle1:{type:"f",value:H},angle2:{type:"f",value:W},texture1:{type:"t",value:A},texture2:{type:"t",value:j},disp:{type:"t",value:M},res:{type:"vec4",value:new s(g.offsetWidth,g.offsetHeight,_,z)},dpr:{type:"f",value:window.devicePixelRatio}},vertexShader:u,fragmentShader:v,transparent:!0,opacity:1}),B=new f(g.offsetWidth,g.offsetHeight,1),J=new l(B,q);U.add(J);var N=0;P&&g.addEventListener("click",G.bind(this,"decrease"),!1),window.addEventListener("resize",function(e){g.offsetHeight/g.offsetWidth<k?(_=1,z=g.offsetHeight/g.offsetWidth/k):(_=g.offsetWidth/g.offsetHeight*k,z=1),J.material.uniforms.res.value=new s(g.offsetWidth,g.offsetHeight,_,z),D.setSize(g.offsetWidth,g.offsetHeight),O()}),this.next=G.bind(this,"increase"),this.previous=G.bind(this,"decrease")}else console.warn("One or more images are missing");else console.warn("Parent missing");function G(e){var t=document.getElementById("img-holder").getAttribute("data-imgArr");t=JSON.parse(t),console.log(t);var i=t;if(console.log(N),orderResult=e,"decrease"!=e||0!=N)if("increase"!=e||N!=i.length-1){if("increase"==orderResult){(S=new n).crossOrigin="",(C=S.load(m,O)).magFilter=C.minFilter=o;var a,d,p=S.load(i[N],O),c=S.load(i[N+1],O);p.magFilter=c.magFilter=o,p.minFilter=c.minFilter=o,g.offsetHeight/g.offsetWidth<(_=y)?(a=1,d=g.offsetHeight/g.offsetWidth/_):(a=g.offsetWidth/g.offsetHeight*_,d=1);var h=new r({uniforms:{intensity1:{type:"f",value:F},intensity2:{type:"f",value:w},dispFactor:{type:"f",value:0},angle1:{type:"f",value:H},angle2:{type:"f",value:W},texture1:{type:"t",value:p},texture2:{type:"t",value:c},disp:{type:"t",value:C},res:{type:"vec4",value:new s(g.offsetWidth,g.offsetHeight,a,d)},dpr:{type:"f",value:window.devicePixelRatio}},vertexShader:u,fragmentShader:v,transparent:!0,opacity:1}),x=new f(g.offsetWidth,g.offsetHeight,1),P=new l(x,h);U.add(P),gsap.to(h.uniforms.dispFactor,{duration:R,value:1,ease:E,onUpdate:O,onComplete:O}),N++}else if("decrease"==orderResult){var S,C,D,V,_;(S=new n).crossOrigin="",(C=S.load(m,O)).magFilter=C.minFilter=o,p=S.load(i[N],O),c=S.load(i[N-1],O),p.magFilter=c.magFilter=o,p.minFilter=c.minFilter=o,g.offsetHeight/g.offsetWidth<(_=y)?(D=1,V=g.offsetHeight/g.offsetWidth/_):(D=g.offsetWidth/g.offsetHeight*_,V=1),h=new r({uniforms:{intensity1:{type:"f",value:F},intensity2:{type:"f",value:w},dispFactor:{type:"f",value:0},angle1:{type:"f",value:H},angle2:{type:"f",value:W},texture1:{type:"t",value:p},texture2:{type:"t",value:c},disp:{type:"t",value:C},res:{type:"vec4",value:new s(g.offsetWidth,g.offsetHeight,D,V)},dpr:{type:"f",value:window.devicePixelRatio}},vertexShader:u,fragmentShader:v,transparent:!0,opacity:1}),x=new f(g.offsetWidth,g.offsetHeight,1),P=new l(x,h),U.add(P),gsap.to(h.uniforms.dispFactor,{duration:b,value:1,ease:E,onUpdate:O,onComplete:O}),N--}}else console.log("out of bounds imgs");else console.log("out of bounds imgs")}}
//# sourceMappingURL=hover-effect.es.js.map
